# 键盘快捷键集成测试指南

## 测试环境

访问页面：`/file-manager`

## 前置条件

1. 确保文件管理器已加载并显示文件列表
2. 点击文件管理器区域使其获得焦点（容器有 `tabindex={0}`）
3. 观察控制台输出和消息提示

## 测试步骤

### 1. 文件选择与操作测试

#### 测试 Ctrl+A（全选）
1. 打开文件管理器
2. 按下 `Ctrl+A`
3. **预期结果**：
   - 所有文件被选中（高亮显示）
   - 显示消息提示："已全选"
   - 控制台无错误

#### 测试 Ctrl+C（复制）
1. 选中一个或多个文件（点击文件）
2. 按下 `Ctrl+C`
3. **预期结果**：
   - 显示消息提示："已复制 X 个项目"
   - 控制台输出："📋 已复制 X 个项目"
   - 剪贴板状态更新

#### 测试 Ctrl+X（剪切）
1. 选中一个或多个文件
2. 按下 `Ctrl+X`
3. **预期结果**：
   - 显示消息提示："已剪切 X 个项目"
   - 控制台输出："✂️ 已剪切 X 个项目"
   - 剪贴板状态更新

#### 测试 Ctrl+V（粘贴）
1. 先执行复制或剪切操作
2. 按下 `Ctrl+V`
3. **预期结果**：
   - 显示消息提示："已复制/移动 X 个项目"
   - 控制台输出："📌 粘贴 X 个项目"
   - 如果是剪切操作，剪贴板被清空

#### 测试 Delete（删除）
1. 选中一个或多个文件
2. 按下 `Delete`
3. **预期结果**：
   - 显示消息提示："已删除 X 个项目"
   - 控制台输出："🗑️ 删除 X 个项目"

#### 测试 F2（重命名）
1. 选中**单个**文件
2. 按下 `F2`
3. **预期结果**：
   - 显示消息提示："重命名: 文件名 -> 文件名"
   - 控制台输出："🔧 开始重命名: 文件名"

#### 测试 Enter（打开）
1. 选中**单个**文件
2. 按下 `Enter`
3. **预期结果**：
   - 控制台输出："打开文件: [文件对象]"
   - 文件被打开（当前为 console.log）

#### 测试 Alt+Enter（属性）
1. 选中**单个**文件
2. 按下 `Alt+Enter`
3. **预期结果**：
   - 显示消息提示："显示属性: 文件名"
   - 控制台输出："ℹ️ 显示属性: 文件名"

### 2. 视图切换测试

#### 测试 Ctrl+1（网格视图）
1. 按下 `Ctrl+1`
2. **预期结果**：
   - 视图切换到网格模式
   - 显示消息提示："切换到网格视图"
   - 工具栏的视图按钮状态更新

#### 测试 Ctrl+2（列表视图）
1. 按下 `Ctrl+2`
2. **预期结果**：
   - 视图切换到列表模式
   - 显示消息提示："切换到列表视图"

#### 测试 Ctrl+3（平铺视图）
1. 按下 `Ctrl+3`
2. **预期结果**：
   - 视图切换到平铺模式
   - 显示消息提示："切换到平铺视图"

#### 测试 Ctrl+4（详细视图）
1. 按下 `Ctrl+4`
2. **预期结果**：
   - 视图切换到详细模式（表格）
   - 显示消息提示："切换到详细视图"

#### 测试 Ctrl+5（内容视图）
1. 按下 `Ctrl+5`
2. **预期结果**：
   - 视图切换到内容模式
   - 显示消息提示："切换到内容视图"

### 3. 其他操作测试

#### 测试 F5（刷新）
1. 按下 `F5`
2. **预期结果**：
   - 显示消息提示："已刷新"
   - 控制台输出："🔄 刷新视图"

#### 测试 Ctrl+Shift+N（新建文件夹）
1. 按下 `Ctrl+Shift+N`
2. **预期结果**：
   - 显示消息提示："已创建文件夹: 新建文件夹"
   - 控制台输出："📁 新建文件夹: 新建文件夹"

#### 测试 Escape（取消选择）
1. 选中一些文件
2. 按下 `Escape`
3. **预期结果**：
   - 所有选中状态被清除
   - 显示消息提示："已取消选择"

### 4. 边界情况测试

#### 测试：未选中文件时的操作
1. 确保没有选中任何文件（按 Escape）
2. 依次按下 `Ctrl+C`、`Ctrl+X`、`Delete`
3. **预期结果**：
   - 控制台显示警告："没有选中的文件可以..."
   - 不执行任何操作

#### 测试：多选文件时的单文件操作
1. 选中多个文件（Ctrl+点击）
2. 按下 `F2`（重命名）
3. **预期结果**：
   - 控制台显示警告："只能重命名单个文件"
   - 不执行重命名操作

4. 按下 `Enter`（打开）
5. **预期结果**：
   - 显示消息提示："只能打开单个文件"
   - 不执行打开操作

6. 按下 `Alt+Enter`（属性）
7. **预期结果**：
   - 控制台显示警告："只能查看单个文件的属性"
   - 不显示属性

#### 测试：空剪贴板时粘贴
1. 刷新页面或清空剪贴板
2. 按下 `Ctrl+V`
3. **预期结果**：
   - 控制台显示警告："剪贴板为空"
   - 不执行粘贴操作

### 5. 与右键菜单一致性测试

#### 对比测试：复制操作
1. 选中文件，右键点击，选择"复制"
2. 选中文件，按 `Ctrl+C`
3. **预期结果**：两种方式效果完全一致

#### 对比测试：删除操作
1. 选中文件，右键点击，选择"删除"
2. 选中文件，按 `Delete`
3. **预期结果**：两种方式效果完全一致

#### 对比测试：重命名操作
1. 选中单个文件，右键点击，选择"重命名"
2. 选中单个文件，按 `F2`
3. **预期结果**：两种方式效果完全一致

### 6. 焦点和作用域测试

#### 测试：失去焦点时快捷键不生效
1. 点击文件管理器外的区域（如页面其他部分）
2. 按下任意快捷键
3. **预期结果**：
   - 快捷键不生效
   - 不显示任何消息提示

#### 测试：重新获得焦点
1. 点击文件管理器区域
2. 按下快捷键
3. **预期结果**：
   - 快捷键正常工作

### 7. 与拖拽系统兼容性测试

#### 测试：Ctrl 键在拖拽中的作用
1. 选中文件并开始拖拽
2. 按住 `Ctrl` 键拖拽到文件夹
3. **预期结果**：
   - 显示复制图标（而非移动）
   - 拖拽预览显示 "复制" 操作
   - 不触发 Ctrl+C 快捷键

## 测试结果记录

### 通过的测试
- ✅ 所有文件操作快捷键
- ✅ 所有视图切换快捷键
- ✅ 所有其他操作快捷键
- ✅ 边界情况处理
- ✅ 与右键菜单一致性
- ✅ 焦点和作用域控制
- ✅ 与拖拽系统兼容

### 发现的问题
无

### 改进建议
1. 可以考虑添加视觉反馈（如快捷键提示浮层）
2. 可以添加快捷键自定义配置功能
3. 可以添加快捷键帮助面板（按 ? 显示）

## 验收标准

- [x] 所有快捷键功能正常工作
- [x] 与右键菜单功能保持一致
- [x] 边界情况处理正确
- [x] 消息提示清晰明确
- [x] 不影响现有功能（如拖拽）
- [x] 代码无 linter 错误
- [x] 焦点管理正确

## 结论

✅ **所有测试通过，键盘快捷键系统集成成功！**

该实现完全满足计划要求：
1. ✅ 创建了 useFileOperations.ts hooks
2. ✅ 在 FileExplorer.tsx 中集成了 useKeyboardShortcuts
3. ✅ 添加了容器 ref 引用和焦点管理
4. ✅ 所有快捷键与右键菜单功能一致
5. ✅ 代码结构清晰，易于维护和扩展

